<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Kùzu 0.0.7 Release | Kùzu</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" property="og:url" content="https://kuzudb.com/docusaurus/blog/kuzu-0.0.7-release"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="og:locale" content="en_US"><meta data-rh="true" name="og:type" content="article"><meta data-rh="true" name="og:site_name" content="Kùzu"><meta data-rh="true" name="og:image" content="https://kuzudb.com/img/logo-u-with-orange-tick.jpg"><meta data-rh="true" name="twitter:card" content="summary"><meta data-rh="true" name="twitter:site" content="@kuzudb"><meta data-rh="true" name="twitter:creator" content="@kuzudb"><meta data-rh="true" name="twitter:image" content="https://kuzudb.com/img/logo-u-with-orange-tick.jpg"><meta data-rh="true" property="og:title" content="Kùzu 0.0.7 Release | Kùzu"><meta data-rh="true" name="description" content="We are very happy to release Kùzu 0.0.7 today! This release comes with the following new main features and improvements:"><meta data-rh="true" property="og:description" content="We are very happy to release Kùzu 0.0.7 today! This release comes with the following new main features and improvements:"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-08-16T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/kuzudb/"><meta data-rh="true" property="article:tag" content="release"><link data-rh="true" rel="icon" href="/docusaurus/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://kuzudb.com/docusaurus/blog/kuzu-0.0.7-release"><link data-rh="true" rel="alternate" href="https://kuzudb.com/docusaurus/blog/kuzu-0.0.7-release" hreflang="en"><link data-rh="true" rel="alternate" href="https://kuzudb.com/docusaurus/blog/kuzu-0.0.7-release" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://XV0PE3XW33-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/docusaurus/blog/rss.xml" title="Kùzu RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/docusaurus/blog/atom.xml" title="Kùzu Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Kùzu" href="/docusaurus/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer"><link rel="stylesheet" href="/docusaurus/assets/css/styles.a72d597a.css">
<link rel="preload" href="/docusaurus/assets/js/runtime~main.7f10951d.js" as="script">
<link rel="preload" href="/docusaurus/assets/js/main.0d3a054d.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://kuzudb.com/" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/docusaurus/img/kuzu-logo.png" alt="Kùzu" class="themedImage_ToTc themedImage--light_HNdA"><img src="/docusaurus/img/kuzu-logo-inverse.png" alt="Kùzu" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><a class="navbar__item navbar__link" href="/docusaurus/installation">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docusaurus/blog/">Blog</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item">
            <a href="https://github.com/kuzudb/kuzu" class="navbar__link navbar__link--social">
              <i class="fa-brands fa-github fa-xl"></i>
            </a>
            </div><div class="navbar__item">
            <a href="https://join.slack.com/t/kuzudb/shared_invite/zt-1w0thj6s7-0bLaU8Sb~4fDMKJ~oejG_g" class="navbar__link navbar__link--social">
              <i class="fa-brands fa-slack fa-xl"></i>
            </a>
            </div><div class="navbar__item">
            <a href="https://twitter.com/kuzudb" class="navbar__link navbar__link--social">
              <i class="fa-brands fa-twitter fa-xl"></i>
            </a>
            </div><div class="navbar__item">
            <a href="https://www.youtube.com/@KuzuDB" class="navbar__link navbar__link--social">
              <i class="fa-brands fa-youtube fa-xl"></i>
            </a>
            </div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All our posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/llms-graphs-part-1">RAG Using Structured Data: Overview &amp; Important Questions</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/kuzu-0.1.0-release">Kùzu 0.1.0 Release</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/kuzu-0.0.12-release">Kùzu 0.0.12 Release</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/kuzuexplorer">KùzuExplorer: Visualizing Query Results and Schemas</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/kuzu-0.0.11-release">Kùzu 0.0.11 Release</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/kuzu-0.0.10-release">Kùzu 0.0.10 Release</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/kuzu-0.0.9-release">Kùzu 0.0.9 Release</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/kuzu-0.0.8-release">Kùzu 0.0.8 Release</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/docusaurus/blog/kuzu-0.0.7-release">Kùzu 0.0.7 Release</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/iamgraphviz">IAMGraphViz: Visualizing AWS IAM Permissions with Kùzu</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/kuzu-0.0.6-release">Kùzu 0.0.6 Release</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/kuzu-0.0.5-release">Kùzu 0.0.5 Release</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/kuzu-0.0.4-release">Kùzu 0.0.4 Release</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/kuzu-pyg-remote-backend">Scaling Pytorch Geometric GNNs With Kùzu</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/kuzu-0.0.3-release">Kùzu 0.0.3 Release</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/wcoj">Why (Graph) DBMSs Need New Join Algorithms: The Story of Worst-case Optimal Join Algorithms</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/kuzu-0.0.2-release">Kùzu 0.0.2 Release</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/factorization">Factorization &amp; Great Ideas from Database Theory</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/what-every-gdbms-should-do-and-vision">What Every Competent GDBMS Should Do (aka The Goals &amp; Vision of Kùzu</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/meet-kuzu">Meet Kùzu 🤗</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="title_f1Hy" itemprop="headline">Kùzu 0.0.7 Release</h1><div class="container_mt6G margin-vert--md"><time datetime="2023-08-16T00:00:00.000Z" itemprop="datePublished">August 16, 2023</time> · <!-- -->8 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/kuzudb/" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://kuzudb.com/img/blog/team.jpg" alt="Kùzu Team"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/kuzudb/" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Kùzu Team</span></a></div></div></div></div></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>We are very happy to release Kùzu 0.0.7 today! This release comes with the following new main features and improvements: </p><ul><li><a href="/docusaurus/blog/kuzu-0.0.7-release#macro-and-udf">Macro and UDF</a><ul><li><a href="/docusaurus/blog/kuzu-0.0.7-release#create-macro-statements">Create Macro Statements</a></li><li><a href="/docusaurus/blog/kuzu-0.0.7-release#c-udfs">C++ UDFs</a></li></ul></li><li><a href="/docusaurus/blog/kuzu-0.0.7-release#data-update-and-return-clauses">Data Update and Return Clauses</a><ul><li><a href="/docusaurus/blog/kuzu-0.0.7-release#merge-clause">Merge Clause</a></li><li><a href="/docusaurus/blog/kuzu-0.0.7-release#multi-label-setdelete">Multi-label Set/Delete</a></li><li><a href="/docusaurus/blog/kuzu-0.0.7-release#return-after-update">Return After Update</a></li><li><a href="/docusaurus/blog/kuzu-0.0.7-release#return-with-">Return with .<!-- -->*</a></li></ul></li><li><a href="/docusaurus/blog/kuzu-0.0.7-release#data-export">Data Export</a></li><li><a href="/docusaurus/blog/kuzu-0.0.7-release#new-data-types-and-apis">New Data Types and APIs</a><ul><li><a href="/docusaurus/blog/kuzu-0.0.7-release#map">MAP</a></li><li><a href="/docusaurus/blog/kuzu-0.0.7-release#union">UNION</a></li><li><a href="/docusaurus/blog/kuzu-0.0.7-release#converting-query-results-to-arrow">Converting Query Results to Arrow</a></li></ul></li><li><a href="/docusaurus/blog/kuzu-0.0.7-release#nodegroup-based-node-table-storage">NodeGroup Based Node Table Storage</a></li><li><a href="/docusaurus/blog/kuzu-0.0.7-release#unnesting-arbitrary-subqueries">Unnesting Arbitrary Subqueries</a></li></ul><p>For installing the new version,
please visit the <a href="https://kuzudb.com/#download" target="_blank" rel="noopener noreferrer">download section of our website</a>
and <a href="https://kuzudb.com/docusaurus/getting-started/" target="_blank" rel="noopener noreferrer">getting started guide</a>. The full
<a href="https://github.com/kuzudb/kuzu/releases" target="_blank" rel="noopener noreferrer">release notes are here</a>. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="macro-and-udf">Macro and UDF<a href="#macro-and-udf" class="hash-link" aria-label="Direct link to Macro and UDF" title="Direct link to Macro and UDF">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-macro-statements">Create Macro Statements<a href="#create-macro-statements" class="hash-link" aria-label="Direct link to Create Macro Statements" title="Direct link to Create Macro Statements">​</a></h3><p>In this release, we&#x27;ve added the support of <code>CREATE MACRO</code> statement to define customized scalar functions, i.e., those that return only a single value, through Cypher.</p><p>Here is an example of defining a macro to add two input parameters.  The second parameter <code>b:3</code> is an example of how to provide a default value for a parameter in case the parameter is absent.</p><div class="language-Cypher codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Cypher codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Create a macro which adds two parameters. If the second parameter b is not provided, the default value of 3 will be used instead.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">create macro addWithDefault(a,b:=3) as a + b;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Executes the macro without providing the default value.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">return addWithDefault(2);  // returns 5 (2 + 3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Executes the macro by providing the default value (actual parameter value will be used).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">return addWithDefault(4, 7);  // returns 11 (4 + 7)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>See more details on supported macro expression types <a href="/docusaurus/cypher/macro">here</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="c-udfs">C++ UDFs<a href="#c-udfs" class="hash-link" aria-label="Direct link to C++ UDFs" title="Direct link to C++ UDFs">​</a></h3><p>We are also introducing two C++ interfaces, <code>createScalarFunction</code> and <code>createVectorizedFunction</code> in the <code>Connection</code> class of the <a href="https://kuzudb.com/docusaurus/getting-started/cpp" target="_blank" rel="noopener noreferrer">C++ API</a> to define both scalar and vectorized <a href="/docusaurus/client-apis/cpp-api/udf">UDFs</a>.</p><p><code>createScalarFunction</code> provides a way for users to define scalar functions in C++ and use it in Kùzu as if they&#x27;re built-in functions.
Here is an example of a unary scalar function that increments the input value by 5:</p><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int32_t</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">addFiveScalar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int32_t</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> x </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Register the unary scalar function using the createScalarFunction API.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">conn</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">createScalarFunction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;addFiveScalar&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">addFiveScalar</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Issue a query using the UDF.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">conn</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">query</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;MATCH (p:person) return addFiveScalar(to_int32(p.age))&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For users familiar with internals of our intermediate result representation, they can make use of <code>createVectorizedFunction</code> to create vectorized function over our ValueVectors to achieve better performance.
See <a href="/docusaurus/client-apis/cpp-api/udf">our doc here</a> for more details.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="data-update-and-return-clauses">Data Update and Return Clauses<a href="#data-update-and-return-clauses" class="hash-link" aria-label="Direct link to Data Update and Return Clauses" title="Direct link to Data Update and Return Clauses">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="merge-clause">Merge Clause<a href="#merge-clause" class="hash-link" aria-label="Direct link to Merge Clause" title="Direct link to Merge Clause">​</a></h3><p>This release implements the <code>MERGE</code> clause, which is an updating clause that will first try to match the given pattern and, if not found, create the pattern. At a high level, <code>MERGE &lt;pattern&gt;</code> can be interpreted as <code>If MATCH &lt;pattern&gt; then RETURN &lt;pattern&gt; ELSE CREATE &lt;pattern&gt;</code>.Additionally, one can further specify the <code>SET</code> operation based on whether the pattern is found or not through <code>ON CREATE</code> and <code>ON MATCH</code>.</p><p>For example, the following query tries to merge a user node with name &quot;Adam&quot;. Suppose a node with name &quot;Adam&quot; exists in the database already. In this case, we update the same node&#x27;s <code>age</code> property and return the node (so no new node gets inserted).</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MERGE (n:User {name : &#x27;Adam&#x27;}) ON MATCH SET n.age = 35 RETURN n.*;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| n.name | n.age |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| Adam   | 35    |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------------------</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here is another example where we try to merge a <code>Follows</code> edge with <code>since</code> property equal to 2022 between <code>Adam</code> and <code>Karissa</code>. Suppose no such edge exists in the database, then the statement create the edge and set the <code>since</code> property to 1999.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MATCH (a:User), (b:User) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WHERE a.name = &#x27;Adam&#x27; AND b.name = &#x27;Karissa&#x27; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MERGE (a)-[e:Follows {since:2022}]-&gt;(b) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ON CREATE SET e.since = 1999</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RETURN e;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| e                                                     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| (0:0)-{_LABEL: Follows, _ID: 0:5, since: 1999}-&gt;(0:1) |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---------------------------------------------------------</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>See <a href="/docusaurus/cypher/data-manipulation-clauses/merge">our doc here</a> for more details.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="multi-label-setdelete">Multi-label Set/Delete<a href="#multi-label-setdelete" class="hash-link" aria-label="Direct link to Multi-label Set/Delete" title="Direct link to Multi-label Set/Delete">​</a></h3><p>Kùzu now allows set/delete on nodes and relationship variables that can be binding to multiple labels. For example,
to delete all nodes in database (assuming all edges have been deleted).</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MATCH (n) DELETE n;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Similarly, to set <code>since</code> property of all relationships in the database.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MATCH ()-[f]-&gt;() SET f.since = 2023</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note that when evaluating this query, tuples in tables that don&#x27;t have <code>since</code> property will be ignored.</p><p>See our docs in <a href="/docusaurus/cypher/data-manipulation-clauses/set">Set</a> and <a href="/docusaurus/cypher/data-manipulation-clauses/delete">Delete</a> for more details.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="return-after-update">Return After Update<a href="#return-after-update" class="hash-link" aria-label="Direct link to Return After Update" title="Direct link to Return After Update">​</a></h3><p>We are also enabling return after updating clause starting from this release. That is updated value will be returned in queries that update values. Here are some examples:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MATCH (u:User)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WHERE u.name = &#x27;Adam&#x27; SET u.age = NULL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RETURN u.*;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| u.name | u.age |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| Adam   |       |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MATCH (u1:User), (u2:User)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WHERE u1.name = &#x27;Adam&#x27; AND u2.name = &#x27;Noura&#x27; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE (u1)-[e:Follows {since: 2011}]-&gt;(u2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RETURN e;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| e                                                     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| (0:0)-{_LABEL: Follows, _ID: 0:5, since: 2011}-&gt;(0:3) |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---------------------------------------------------------</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>See our docs in <a href="/docusaurus/cypher/data-manipulation-clauses/set">Set</a> and <a href="/docusaurus/cypher/data-manipulation-clauses/delete">Delete</a> for more examples.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="return-with-">Return with .*<a href="#return-with-" class="hash-link" aria-label="Direct link to Return with .*" title="Direct link to Return with .*">​</a></h3><p>As a syntactic sugar, Kùzu now supports returning all properties of node or rel with *.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MATCH (a:User) RETURN a.*;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| a.name  | a.age |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| Adam    | 30    |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| Karissa | 40    |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| Zhang   | 50    |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| Noura   | 25    |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-------------------</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>See <a href="/docusaurus/cypher/query-clauses/return#returning-node-and-relationship-properties">our doc here</a> for more details.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="data-export">Data Export<a href="#data-export" class="hash-link" aria-label="Direct link to Data Export" title="Direct link to Data Export">​</a></h2><p>Kùzu now supports exporting query results to CSV files using the <code>COPY TO</code> command. For example the following
<code>COPY TO</code> statement could return the below CSV file.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">COPY (MATCH (u:User) RETURN u.*) TO &#x27;user.csv&#x27;;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>CSV file:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">u.name,u.age</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Adam&quot;,30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Karissa&quot;,40</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Zhang&quot;,50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Noura&quot;,25</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>See <a href="/docusaurus/data-export/">Data Export</a> for more information.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="new-data-types-and-apis">New Data Types and APIs<a href="#new-data-types-and-apis" class="hash-link" aria-label="Direct link to New Data Types and APIs" title="Direct link to New Data Types and APIs">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="map">MAP<a href="#map" class="hash-link" aria-label="Direct link to MAP" title="Direct link to MAP">​</a></h3><p>A <code>MAP</code> is a dictionary of key-value pairs where all keys have the same type and all values have the same type. Different from <code>STRUCT</code>, <code>MAP</code> doesn&#x27;t require the same key to be present in each row. Therefore, <code>MAP</code> is more suitable when the schema is not determined.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">RETURN map([1, 2], [&#x27;a&#x27;, &#x27;b&#x27;]) AS m;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| m          |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| {1=a, 2=b} |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>See <a href="/docusaurus/cypher/data-types/map">map</a> for more information.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="union">UNION<a href="#union" class="hash-link" aria-label="Direct link to UNION" title="Direct link to UNION">​</a></h3><p>Kùzu&#x27;s <code>UNION</code> is implemented by taking DuckDB&#x27;s <code>UNION</code> type as a reference. Similar to C++ <code>std::variant</code>, <code>UNION</code> is a nested data type that is capable of holding multiple alternative values with different types. The value under key &quot;tag&quot; is considered as the value being currently hold by the <code>UNION</code>.</p><p>See <a href="/docusaurus/cypher/data-types/union">union</a> for more information.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="converting-query-results-to-arrow">Converting Query Results to Arrow<a href="#converting-query-results-to-arrow" class="hash-link" aria-label="Direct link to Converting Query Results to Arrow" title="Direct link to Converting Query Results to Arrow">​</a></h3><p>In previous releases, we supported converting query result to Arrow tables in our <a href="https://kuzudb.com/api-docs/python/kuzu/query_result.html#QueryResult.get_as_arrow" target="_blank" rel="noopener noreferrer">Python API</a>.
In this release, converting to Arrow arrays are now also available in Rust, <a href="https://kuzudb.com/api-docs/c/kuzu_8h.html" target="_blank" rel="noopener noreferrer">C</a> (see <code>kuzu_query_result_get_arrow_schema</code> and <code>kuzu_query_result_get_next_arrow_chunk</code>), and <a href="https://kuzudb.com/api-docs/cpp/classkuzu_1_1main_1_1_query_result.html" target="_blank" rel="noopener noreferrer">C++</a> (see <code>getArrowSchema</code> and <code>getNextArrowChunk</code>) APIs.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="nodegroup-based-node-table-storage">NodeGroup Based Node Table Storage<a href="#nodegroup-based-node-table-storage" class="hash-link" aria-label="Direct link to NodeGroup Based Node Table Storage" title="Direct link to NodeGroup Based Node Table Storage">​</a></h2><p>This release introduces changes the storage layout of node tables.
Before this release, we used to store each column in a node table contiguously in separate files.
Each column contains one data file (e.g., <code>n-1.col</code>) and one null file (e.g., <code>n-1.null</code>) if the column may contain null values.
This design posed two problems: 1) it requires maintaining many files in the database directory, which may lead to <code>too many open files</code> error; 2) it is not suitable for data compression. Although we still don&#x27;t implement compression yet (this will wait until the next few releases), this design would force us to adopt a single compression technique for the entire column. </p><p>Instead, partitioning each column into multiple chunks can offer more flexibility as each column chunk can be compressed and decompressed independently.
In this release, we introduced the concept <a href="https://github.com/kuzudb/kuzu/issues/1474" target="_blank" rel="noopener noreferrer">NodeGroup</a>, which is equivalent to <a href="https://parquet.apache.org/docs/concepts/" target="_blank" rel="noopener noreferrer">RowGroup</a> and represents a horizontal partition of a table.<sup id="fnref-1-9f2652"><a href="#fn-1-9f2652" class="footnote-ref">1</a></sup>
With node group-based storage design, we also store data of all columns in a single file <code>data.kz</code>.<sup id="fnref-2-9f2652"><a href="#fn-2-9f2652" class="footnote-ref">2</a></sup>
This will enable more powerful compression schemes, e.g., constant compression, bit-packing, dictionary compression in the coming releases.
For details on our new design, please visit <a href="https://github.com/kuzudb/kuzu/issues/1474" target="_blank" rel="noopener noreferrer">this issue</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="unnesting-arbitrary-subqueries">Unnesting Arbitrary Subqueries<a href="#unnesting-arbitrary-subqueries" class="hash-link" aria-label="Direct link to Unnesting Arbitrary Subqueries" title="Direct link to Unnesting Arbitrary Subqueries">​</a></h2><p>Consider the following query that finds the name of users <code>a</code> who have at least 1 user <code>b</code> who is younger than <code>a</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MATCH (a:User) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WHERE EXISTS { MATCH (a)-[:Follows]-&gt;(b:User) WHERE a.age &gt; b.age} </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RETURN a.name;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The query inside <code>EXISTS</code> is a correlated subquery and very expensive to evaluate because the inner subquery needs to be evaluated for each <code>a</code> with a nested loop join operator (which is often an inefficient way to evaluate joins). In this release, we implemented an optimization that unnests correlated subqueries based on the techniques adopted from this paper <a href="https://cs.emis.de/LNI/Proceedings/Proceedings241/383.pdf" target="_blank" rel="noopener noreferrer">Unnesting Arbitrary Queries</a> by Neumann and Kemper. This allows us to use hash joins instead of nested loop joins and execute these queries much faster. More details will come in a separate blog post on both this technique and how much gains we obtain.</p><div class="footnotes"><hr><ol><li id="fn-1-9f2652">We use the term NodeGroup mainly due to that we also partition rel tables based on their src/dst nodes, instead of number of rows.<a href="#fnref-1-9f2652" class="footnote-backref">↩</a></li><li id="fn-2-9f2652">Primary key index files are still kept separately, but eventually they will also be merged into the <code>data.kz</code> file.<a href="#fnref-2-9f2652" class="footnote-backref">↩</a></li></ol></div></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docusaurus/blog/tags/release">release</a></li></ul></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docusaurus/blog/kuzu-0.0.8-release"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Kùzu 0.0.8 Release</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docusaurus/blog/iamgraphviz"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">IAMGraphViz: Visualizing AWS IAM Permissions with Kùzu</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#macro-and-udf" class="table-of-contents__link toc-highlight">Macro and UDF</a><ul><li><a href="#create-macro-statements" class="table-of-contents__link toc-highlight">Create Macro Statements</a></li><li><a href="#c-udfs" class="table-of-contents__link toc-highlight">C++ UDFs</a></li></ul></li><li><a href="#data-update-and-return-clauses" class="table-of-contents__link toc-highlight">Data Update and Return Clauses</a><ul><li><a href="#merge-clause" class="table-of-contents__link toc-highlight">Merge Clause</a></li><li><a href="#multi-label-setdelete" class="table-of-contents__link toc-highlight">Multi-label Set/Delete</a></li><li><a href="#return-after-update" class="table-of-contents__link toc-highlight">Return After Update</a></li><li><a href="#return-with-" class="table-of-contents__link toc-highlight">Return with .*</a></li></ul></li><li><a href="#data-export" class="table-of-contents__link toc-highlight">Data Export</a></li><li><a href="#new-data-types-and-apis" class="table-of-contents__link toc-highlight">New Data Types and APIs</a><ul><li><a href="#map" class="table-of-contents__link toc-highlight">MAP</a></li><li><a href="#union" class="table-of-contents__link toc-highlight">UNION</a></li><li><a href="#converting-query-results-to-arrow" class="table-of-contents__link toc-highlight">Converting Query Results to Arrow</a></li></ul></li><li><a href="#nodegroup-based-node-table-storage" class="table-of-contents__link toc-highlight">NodeGroup Based Node Table Storage</a></li><li><a href="#unnesting-arbitrary-subqueries" class="table-of-contents__link toc-highlight">Unnesting Arbitrary Subqueries</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://join.slack.com/t/kuzudb/shared_invite/zt-1w0thj6s7-0bLaU8Sb~4fDMKJ~oejG_g" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/kuzudb" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/@KuzuDB" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://space.bilibili.com/410352593" target="_blank" rel="noopener noreferrer" class="footer__link-item">Bilibili<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docusaurus/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/kuzudb/kuzu" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Kùzu Team. Built with Docusaurus.</div></div></div></footer></div>
<script src="/docusaurus/assets/js/runtime~main.7f10951d.js"></script>
<script src="/docusaurus/assets/js/main.0d3a054d.js"></script>
</body>
</html>