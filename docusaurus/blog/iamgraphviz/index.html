<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">IAMGraphViz: Visualizing AWS IAM Permissions with Kùzu | Kùzu</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" property="og:image" content="https://kuzudb.com/img/logo-u-with-orange-tick.jpg"><meta data-rh="true" property="og:url" content="https://kuzudb.com/docusaurus/blog/iamgraphviz"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="og:locale" content="en_US"><meta data-rh="true" name="og:type" content="article"><meta data-rh="true" name="og:site_name" content="Kùzu"><meta data-rh="true" name="og:image" content="https://kuzudb.com/img/logo-u-with-orange-tick.jpg"><meta data-rh="true" name="twitter:card" content="summary"><meta data-rh="true" name="twitter:site" content="@kuzudb"><meta data-rh="true" name="twitter:creator" content="@kuzudb"><meta data-rh="true" name="twitter:image" content="https://kuzudb.com/img/logo-u-with-orange-tick.jpg"><meta data-rh="true" property="og:title" content="IAMGraphViz: Visualizing AWS IAM Permissions with Kùzu | Kùzu"><meta data-rh="true" name="description" content="IAMGraphViz Overview"><meta data-rh="true" property="og:description" content="IAMGraphViz Overview"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-07-19T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://www.linkedin.com/in/chrnorm/?originalSubdomain=uk,https://www.linkedin.com/in/mewim/"><meta data-rh="true" property="article:tag" content="use-case"><link data-rh="true" rel="icon" href="/docusaurus/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://kuzudb.com/docusaurus/blog/iamgraphviz"><link data-rh="true" rel="alternate" href="https://kuzudb.com/docusaurus/blog/iamgraphviz" hreflang="en"><link data-rh="true" rel="alternate" href="https://kuzudb.com/docusaurus/blog/iamgraphviz" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://XV0PE3XW33-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/docusaurus/blog/rss.xml" title="Kùzu RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/docusaurus/blog/atom.xml" title="Kùzu Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Kùzu" href="/docusaurus/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer"><link rel="stylesheet" href="/docusaurus/assets/css/styles.c2b07602.css">
<link rel="preload" href="/docusaurus/assets/js/runtime~main.90a0e02b.js" as="script">
<link rel="preload" href="/docusaurus/assets/js/main.49b4fd23.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://kuzudb.com/" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/docusaurus/img/kuzu-logo.png" alt="Kùzu" class="themedImage_ToTc themedImage--light_HNdA"><img src="/docusaurus/img/kuzu-logo-inverse.png" alt="Kùzu" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><a class="navbar__item navbar__link" href="/docusaurus/installation">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docusaurus/blog/">Blog</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item">
            <a href="https://github.com/kuzudb/kuzu" class="navbar__link navbar__link--social">
              <i class="fa-brands fa-github fa-xl"></i>
            </a>
            </div><div class="navbar__item">
            <a href="https://discord.gg/jw7xN2ZhJB" class="navbar__link navbar__link--social">
              <i class="fa-brands fa-discord fa-xl"></i>
            </a>
            </div><div class="navbar__item">
            <a href="https://twitter.com/kuzudb" class="navbar__link navbar__link--social">
              <i class="fa-brands fa-twitter fa-xl"></i>
            </a>
            </div><div class="navbar__item">
            <a href="https://www.youtube.com/@KuzuDB" class="navbar__link navbar__link--social">
              <i class="fa-brands fa-youtube fa-xl"></i>
            </a>
            </div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All our posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/kuzu-0.2.0-release">Kùzu 0.2.0 Release</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/transforming-your-data-to-graphs-1">Transforming your data to graphs - Part 1</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/llms-graphs-part-2">RAG Using Unstructured Data &amp; Role of Knowledge Graphs</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/llms-graphs-part-1">RAG Using Structured Data: Overview &amp; Important Questions</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/kuzu-0.1.0-release">Kùzu 0.1.0 Release</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/kuzu-0.0.12-release">Kùzu 0.0.12 Release</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/kuzuexplorer">KùzuExplorer: Visualizing Query Results and Schemas</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/kuzu-0.0.11-release">Kùzu 0.0.11 Release</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/kuzu-0.0.10-release">Kùzu 0.0.10 Release</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/kuzu-0.0.9-release">Kùzu 0.0.9 Release</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/kuzu-0.0.8-release">Kùzu 0.0.8 Release</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/kuzu-0.0.7-release">Kùzu 0.0.7 Release</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/docusaurus/blog/iamgraphviz">IAMGraphViz: Visualizing AWS IAM Permissions with Kùzu</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/kuzu-0.0.6-release">Kùzu 0.0.6 Release</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/kuzu-0.0.5-release">Kùzu 0.0.5 Release</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/kuzu-0.0.4-release">Kùzu 0.0.4 Release</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/kuzu-pyg-remote-backend">Scaling Pytorch Geometric GNNs With Kùzu</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/kuzu-0.0.3-release">Kùzu 0.0.3 Release</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/wcoj">Why (Graph) DBMSs Need New Join Algorithms: The Story of Worst-case Optimal Join Algorithms</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/kuzu-0.0.2-release">Kùzu 0.0.2 Release</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/factorization">Factorization &amp; Great Ideas from Database Theory</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/what-every-gdbms-should-do-and-vision">What Every Competent GDBMS Should Do (aka The Goals &amp; Vision of Kùzu)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus/blog/meet-kuzu">Meet Kùzu 🤗</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="title_f1Hy" itemprop="headline">IAMGraphViz: Visualizing AWS IAM Permissions with Kùzu</h1><div class="container_mt6G margin-vert--md"><time datetime="2023-07-19T00:00:00.000Z" itemprop="datePublished">July 19, 2023</time> · <!-- -->7 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://www.linkedin.com/in/chrnorm/?originalSubdomain=uk" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://www.commonfate.io/_next/image?url=%2Fheadshots%2Fchris.jpg&amp;w=3840&amp;q=75" alt="Chris Norman"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://www.linkedin.com/in/chrnorm/?originalSubdomain=uk" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Chris Norman</span></a></div><small class="avatar__subtitle" itemprop="description">Common Fate</small></div></div></div><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://www.linkedin.com/in/mewim/" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://kuzudb.com/img/blog/chang.gif" alt="Chang Liu"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://www.linkedin.com/in/mewim/" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Chang Liu</span></a></div></div></div></div></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="iamgraphviz-overview">IAMGraphViz Overview<a href="#iamgraphviz-overview" class="hash-link" aria-label="Direct link to IAMGraphViz Overview" title="Direct link to IAMGraphViz Overview">​</a></h2><p><a href="https://www.commonfate.io/" target="_blank" rel="noopener noreferrer">Common Fate</a>  is a framework for managing complex cloud permissions. They provide tools to simplify access at scale to AWS, Azure, and Google Cloud accounts. You can learn about what you can do with Common Fate on <a href="https://www.commonfate.io/" target="_blank" rel="noopener noreferrer">their website</a>. Here, we will talk about a recent proof of concept graph visualization tool called IAMGraphViz that <a href="https://www.linkedin.com/in/mewim/" target="_blank" rel="noopener noreferrer">Chang Liu</a> (who is coauthoring this post) and I developed using Kùzu! IAMGraphViz is intended for infrastructure engineers to dig deep into the permission assignments in AWS IAM Identity Center using graph visualization. Using IAMGraphViz, one can easily visualize who has what type of access to different accounts on AWS as well as how they have access to these accounts. This is all done by analyzing the paths from users to accounts in a graph visualization, where the nodes and edges model users, accounts, groups, group memberships, permission sets and other entities in the AWS IAM Identity Center system.</p><p>The IAMGraphViz project is designed and implemented as a web application using a graph DBMS (GDBMS) to store and retrieve data. Before landing on Kùzu, we surveyed using several other GDBMSs, such as Neo4j, but they were all harder to use. Neo4j, for example, requires hosting a separate database. We then discovered Kùzu, which only required a <code>pip install</code> and import statement and we could simply embed it into our application. In this project our datasets could fit entirely onto a single compute node,and so Kùzu was far simpler for us to work with than alternatives. Kùzu is also far cheaper and more serverless-friendly than running a separate database.</p><p>This post follows the <a href="https://colab.research.google.com/drive/1fotlNnOj1FGad6skBG7MRrHVdHd3jIl6" target="_blank" rel="noopener noreferrer">Colab</a> that Chang Liu created after we discussed this use case together.</p><p>So let&#x27;s get to it!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="quick-aws-iam-overview">Quick AWS IAM Overview<a href="#quick-aws-iam-overview" class="hash-link" aria-label="Direct link to Quick AWS IAM Overview" title="Direct link to Quick AWS IAM Overview">​</a></h2><p>We will use the data model shown in the figure below that faithfully (but partially) models the
core concepts of AWS IAM permission management. Let&#x27;s first review these concepts, all
of which will be modeled as nodes in Kùzu, as a background.
We will provide as simple definitions as we can to keep the post short and provide links
to necessary AWS IAM documentation: </p><div class="img-center"><img loading="lazy" src="/docusaurus/assets/images/schema-a1a8655501405ee6c34e17165daac04b.png" width="600" class="img_ev3q"></div><ol><li><p><strong><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_users.html" target="_blank" rel="noopener noreferrer">User</a></strong> represents a
user, e.g., an actual human user, who can get access to AWS accounts (and through accounts to AWS resources).</p></li><li><p><strong><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_groups.html" target="_blank" rel="noopener noreferrer">Group</a></strong> is a collection of IAM users and lets you specify permissions for multiple users at a time (e.g., you could have a user group called Admins with typical administrator permissions).
To follow the APIs we use, instead of linking Users to Groups through a direct edge, we will do this (a bit redundantly) through a GroupMembership node.</p></li><li><p><strong><a href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_getting-started_concepts.html#account" target="_blank" rel="noopener noreferrer">Account</a></strong>: An AWS account is the basic container for your AWS resources, such as s3 buckets,
Amazon Relational Database Service (Amazon RDS) databases, or Amazon Elastic Compute Cloud instances.
Using multiple AWS accounts is a common practice for many reasons, e.g., providing a natural billing boundary for costs or isolating resources for security. Common Fate customers have hundreds of
accounts, which is not an extreme.</p></li><li><p><strong><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html" target="_blank" rel="noopener noreferrer">IAM Policy</a></strong>, and <strong><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-vs-inline.html#aws-managed-policies" target="_blank" rel="noopener noreferrer">ManagedPolicy</a></strong>: An IAM policy contains permissions for using some AWS resources. An AWS managed policy is a policy with a unique Amazon Resource Name (ARN), e.g., <code>arn:aws:iam::aws:policy/IAMReadOnlyAccess</code>, that is administered by AWS. Managed policies are common policies used by many enterprises. Managed policies are simpler to use than writing your custom policies.
For simplicity, we will only model AWS managed policies in this post.</p></li><li><p><strong><a href="https://docs.aws.amazon.com/singlesignon/latest/userguide/permissionsetsconcept.html" target="_blank" rel="noopener noreferrer">PermissionSet</a></strong> is a set of policies that can be attached to users or groups (through AccountAssignments which we explain momentarily). For example, you can create a Database Admin permission set that includes policies for administering Amazon RDS, DynamoDB, and Aurora services, and use that single permission set to grant access to a list of target AWS accounts. Similar to GroupMembership nodes, to follow the APIs we use, instead of linking ManagedPolicy nodes to PermissionSet nodes through a direct edge, we will link them through a ManagedPolicyAttachment node.</p></li><li><p><strong><a href="https://aws.amazon.com/about-aws/whats-new/2020/09/aws-single-sign-on-adds-account-assignment-apis-and-aws-cloudformation-support-to-automate-multi-account-access-management/" target="_blank" rel="noopener noreferrer">Account Assignment</a></strong>: We will connect user and/or groups to AWS accounts with a specific permission set through an <code>AccountAssignment</code> node (see the schema above). </p></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="example-visualizations">Example Visualizations<a href="#example-visualizations" class="hash-link" aria-label="Direct link to Example Visualizations" title="Direct link to Example Visualizations">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-generation">Data Generation<a href="#data-generation" class="hash-link" aria-label="Direct link to Data Generation" title="Direct link to Data Generation">​</a></h3><p>In the attached <a href="https://colab.research.google.com/drive/1fotlNnOj1FGad6skBG7MRrHVdHd3jIl6" target="_blank" rel="noopener noreferrer">Colab notebook</a>, we first generate some test data
containing Users, Groups, ManagedPolicies, PermissionSets etc. For simplicity, we assume that there are three fixed groups: &quot;Admins&quot;, &quot;Developers&quot;, and &quot;Auditors&quot; and three ManagedPolicies: &quot;AdministratorAccess&quot;, &quot;PowerUserAccess&quot;, and &quot;ReadOnlyAccess&quot;. Users, Accounts,
AccountAssignments, and PermissionSets are randomly generated and we randomly link different nodes to
other nodes according to our schema.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="visualization-1-draw-all-users-with-direct-or-indirect-readonlyaccess-access-to-an-account">Visualization 1: Draw all users with direct or indirect <code>ReadOnlyAccess</code> access to an account<a href="#visualization-1-draw-all-users-with-direct-or-indirect-readonlyaccess-access-to-an-account" class="hash-link" aria-label="Direct link to visualization-1-draw-all-users-with-direct-or-indirect-readonlyaccess-access-to-an-account" title="Direct link to visualization-1-draw-all-users-with-direct-or-indirect-readonlyaccess-access-to-an-account">​</a></h3><p>In our first query, we are given a particular account we would like to investigate and find
all users who have <code>ReadOnlyAccess</code> to the resources of this account. Let&#x27;s assume
the account&#x27;s name is &quot;account-db2071&quot;.</p><div class="language-cypher codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cypher codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MATCH (u:User)&lt;-[l*1..3]-(aa:AccountAssignment)-[l5]-(a:Account),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(aa:AccountAssignment)-[aaps]-&gt;(ps:PermissionSet)&lt;-[psmpa]-(mpa:ManagedPolicyAttachment)-[mpap]-&gt;(p:ManagedPolicy)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WHERE p.id = &quot;arn:aws:iam::aws:policy/ReadOnlyAccess&quot; AND a.sid = &quot;account-db2071&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RETURN *;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In the actual IAMGraphViz implementation, we template this query with two parameters, one for the
account ID, and one for the managed policy, which users pick interactively by selecting from
a dropdown menu.
Note also that the <code>[:*1..3]</code> binding is a variable-length path because we want to find
both the direct connections from a <code>User</code> to an <code>AccountAssignment</code> (that is further connected to
<code>ManagedPolicy</code>) as well as
indirect connections through a <code>Group</code> node. The visualization we generate is shown below:</p><div class="img-center"><img loading="lazy" src="/docusaurus/assets/images/readonlyviz-01a07dc37ec55c977e7a98acb5396133.png" class="img_ev3q"></div><p>Note the presence of both directly and indirectly connected users to the account.
The visualization in both the actual implementation and the <a href="https://colab.research.google.com/drive/1fotlNnOj1FGad6skBG7MRrHVdHd3jIl6" target="_blank" rel="noopener noreferrer">Colab notebook</a> is generated simply
by converting the results of the query into the node and link objects of the graph visualization library,
e.g., pyvis in the case of the Colab notebook.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="visualization-2-draw-all-accounts-a-user-has-administratoraccess-to">Visualization 2: Draw all accounts a user has <code>AdministratorAccess</code> to<a href="#visualization-2-draw-all-accounts-a-user-has-administratoraccess-to" class="hash-link" aria-label="Direct link to visualization-2-draw-all-accounts-a-user-has-administratoraccess-to" title="Direct link to visualization-2-draw-all-accounts-a-user-has-administratoraccess-to">​</a></h3><p>In our second query, we are given a particular user we would like to investigate and find all accounts that the user has <code>AdministratorAccess</code> to. Let&#x27;s assume the user&#x27;s name is &quot;Steven Rose&quot;. </p><p>To retrive the accounts, we define a Cypher query very similar to the previous one. The only difference is that, instead of using the account as query predicate, we now use the user. The query is as follows:</p><div class="language-cypher codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cypher codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MATCH (u:User)&lt;-[l*1..3]-(aa:AccountAssignment)-[l5]-(a:Account),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(aa:AccountAssignment)-[aaps]-&gt;(ps:PermissionSet)&lt;-[psmpa]-(mpa:ManagedPolicyAttachment)-[mpap]-&gt;(p:ManagedPolicy)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WHERE p.id = &quot;arn:aws:iam::aws:policy/AdministratorAccess&quot; AND u.name = &quot;Steven Rose&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RETURN *;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The visualization we generate is shown below:</p><div class="img-center"><img loading="lazy" src="/docusaurus/assets/images/adminviz-81efff2ce0d12c4a702fc8628963f727.png" class="img_ev3q"></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="closing-words">Closing Words<a href="#closing-words" class="hash-link" aria-label="Direct link to Closing Words" title="Direct link to Closing Words">​</a></h2><p>Many other graph visualizations can be helpful for infrastructure engineers to analyze the
IAM network of an enterprise. For example, to find inconsistent privileges given to users,
we might want to <em>find and plot multiple paths from a user to an account with different privileges</em>.
Or we might want to extend our model with more fine grained resources that are connected to accounts
and analyze paths from users to these resources (see the <a href="https://github.com/nccgroup/PMapper" target="_blank" rel="noopener noreferrer">PMapper</a> project that models the IAM data in a more detailed way). The key takeaway is this: graph visualizations can be very powerful to analyze cloud permission data and embedding Kùzu into your applications
to develop tools like IAMGraphViz is extremely easy and fun 🥳🙌💪!</p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docusaurus/blog/tags/use-case">use-case</a></li></ul></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docusaurus/blog/kuzu-0.0.7-release"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Kùzu 0.0.7 Release</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docusaurus/blog/kuzu-0.0.6-release"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Kùzu 0.0.6 Release</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#iamgraphviz-overview" class="table-of-contents__link toc-highlight">IAMGraphViz Overview</a></li><li><a href="#quick-aws-iam-overview" class="table-of-contents__link toc-highlight">Quick AWS IAM Overview</a></li><li><a href="#example-visualizations" class="table-of-contents__link toc-highlight">Example Visualizations</a><ul><li><a href="#data-generation" class="table-of-contents__link toc-highlight">Data Generation</a></li><li><a href="#visualization-1-draw-all-users-with-direct-or-indirect-readonlyaccess-access-to-an-account" class="table-of-contents__link toc-highlight">Visualization 1: Draw all users with direct or indirect <code>ReadOnlyAccess</code> access to an account</a></li><li><a href="#visualization-2-draw-all-accounts-a-user-has-administratoraccess-to" class="table-of-contents__link toc-highlight">Visualization 2: Draw all accounts a user has <code>AdministratorAccess</code> to</a></li></ul></li><li><a href="#closing-words" class="table-of-contents__link toc-highlight">Closing Words</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://join.slack.com/t/kuzudb/shared_invite/zt-1w0thj6s7-0bLaU8Sb~4fDMKJ~oejG_g" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/kuzudb" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/@KuzuDB" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://space.bilibili.com/410352593" target="_blank" rel="noopener noreferrer" class="footer__link-item">Bilibili<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docusaurus/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/kuzudb/kuzu" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Kùzu Team. Built with Docusaurus.</div></div></div></footer></div>
<script src="/docusaurus/assets/js/runtime~main.90a0e02b.js"></script>
<script src="/docusaurus/assets/js/main.49b4fd23.js"></script>
</body>
</html>