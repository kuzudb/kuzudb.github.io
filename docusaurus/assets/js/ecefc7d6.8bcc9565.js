"use strict";(self.webpackChunkkuzu_docs=self.webpackChunkkuzu_docs||[]).push([[6598],{3905:(t,e,n)=>{n.d(e,{Zo:()=>u,kt:()=>k});var a=n(7294);function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e){if(null==t)return{};var n,a,r=function(t,e){if(null==t)return{};var n,a,r={},l=Object.keys(t);for(a=0;a<l.length;a++)n=l[a],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}var o=a.createContext({}),p=function(t){var e=a.useContext(o),n=e;return t&&(n="function"==typeof t?t(e):i(i({},e),t)),n},u=function(t){var e=p(t.components);return a.createElement(o.Provider,{value:e},t.children)},d="mdxType",m={inlineCode:"code",wrapper:function(t){var e=t.children;return a.createElement(a.Fragment,{},e)}},c=a.forwardRef((function(t,e){var n=t.components,r=t.mdxType,l=t.originalType,o=t.parentName,u=s(t,["components","mdxType","originalType","parentName"]),d=p(n),c=r,k=d["".concat(o,".").concat(c)]||d[c]||m[c]||l;return n?a.createElement(k,i(i({ref:e},u),{},{components:n})):a.createElement(k,i({ref:e},u))}));function k(t,e){var n=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var l=n.length,i=new Array(l);i[0]=c;var s={};for(var o in e)hasOwnProperty.call(e,o)&&(s[o]=e[o]);s.originalType=t,s[d]="string"==typeof t?t:r,i[1]=s;for(var p=2;p<l;p++)i[p]=n[p];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},4371:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>o,contentTitle:()=>i,default:()=>m,frontMatter:()=>l,metadata:()=>s,toc:()=>p});var a=n(7462),r=(n(7294),n(3905));const l={title:"httpfs",sidebar_position:1},i="httpfs Extension",s={unversionedId:"extensions/httpfs",id:"extensions/httpfs",title:"httpfs",description:"The httpfs extension extends K\xf9zu file system by allowing reading from/writing to files hosted on",source:"@site/docs/extensions/httpfs.md",sourceDirName:"extensions",slug:"/extensions/httpfs",permalink:"/docusaurus/extensions/httpfs",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{title:"httpfs",sidebar_position:1},sidebar:"docSidebar",previous:{title:"Overview",permalink:"/docusaurus/extensions/"},next:{title:"Contributor Agreement",permalink:"/docusaurus/CLA"}},o={},p=[{value:"HTTP(S) file system",id:"https-file-system",level:2},{value:"S3 file system",id:"s3-file-system",level:2},{value:"S3 file system configuration",id:"s3-file-system-configuration",level:3},{value:"Requirements on the S3 server API",id:"requirements-on-the-s3-server-api",level:2},{value:"Reading from S3:",id:"reading-from-s3",level:2},{value:"Glob",id:"glob",level:2},{value:"Uploading to S3",id:"uploading-to-s3",level:2},{value:"AWS credential management",id:"aws-credential-management",level:2}],u={toc:p},d="wrapper";function m(t){let{components:e,...n}=t;return(0,r.kt)(d,(0,a.Z)({},u,n,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"httpfs-extension"},"httpfs Extension"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"httpfs")," extension extends K\xf9zu file system by allowing reading from/writing to files hosted on\nremote file systems. Over plain HTTP(S) the extension only supports reading files.\nWhen using object storage via the S3 API, the extension supports reading, writing and globbing files."),(0,r.kt)("h1",{id:"usage"},"Usage"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"httpfs")," is an official extension developed and maintained by K\xf9zu.\nIt can be installed and loaded using the following commands:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"INSTALL httpfs;\nLOAD httpfs;\n")),(0,r.kt)("h2",{id:"https-file-system"},"HTTP(S) file system"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"httpfs")," allows users to read from a file hosted on a http(s) server in the same way as from a local file.\nExample:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'LOAD FROM "https://raw.githubusercontent.com/kuzudb/extension/main/dataset/test/city.csv" \nRETURN *;\n')),(0,r.kt)("p",null,"Result:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Waterloo|150000\nKitchener|200000\nGuelph|75000\n")),(0,r.kt)("h2",{id:"s3-file-system"},"S3 file system"),(0,r.kt)("p",null,"The extension also allows users to read/write/glob files hosted on object storage servers using the S3 API."),(0,r.kt)("h3",{id:"s3-file-system-configuration"},"S3 file system configuration"),(0,r.kt)("p",null,"Before reading and writing from S3, users have to configure using the ",(0,r.kt)("a",{parentName:"p",href:"https://kuzudb.com/docusaurus/cypher/configuration"},"CALL")," statement."),(0,r.kt)("p",null,"Supported options:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Option name"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"s3_access_key_id")),(0,r.kt)("td",{parentName:"tr",align:null},"S3 access key id")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"s3_secret_access_key")),(0,r.kt)("td",{parentName:"tr",align:null},"S3 secret access key")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"s3_endpoint")),(0,r.kt)("td",{parentName:"tr",align:null},"S3 endpoint")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"s3_url_style")),(0,r.kt)("td",{parentName:"tr",align:null},"Uses ",(0,r.kt)("a",{parentName:"td",href:"https://docs.aws.amazon.com/AmazonS3/latest/userguide/VirtualHosting.html"},"S3 url style")," (should either be vhost or path)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"s3_region")),(0,r.kt)("td",{parentName:"tr",align:null},"S3 region")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"s3_uploader_max_num_parts_per_file")),(0,r.kt)("td",{parentName:"tr",align:null},"Used for ",(0,r.kt)("a",{parentName:"td",href:"https://docs.aws.amazon.com/AmazonS3/latest/userguide/qfacts.html"},"part size calculation"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"s3_uploader_max_filesize")),(0,r.kt)("td",{parentName:"tr",align:null},"Used for ",(0,r.kt)("a",{parentName:"td",href:"https://docs.aws.amazon.com/AmazonS3/latest/userguide/qfacts.html"},"part size calculation"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"s3_uploader_threads_limit")),(0,r.kt)("td",{parentName:"tr",align:null},"Maximum number of uploader threads")))),(0,r.kt)("h2",{id:"requirements-on-the-s3-server-api"},"Requirements on the S3 server API"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Feature"),(0,r.kt)("th",{parentName:"tr",align:null},"Required S3 API features"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Public file reads"),(0,r.kt)("td",{parentName:"tr",align:null},"HTTP Range request")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Private file reads"),(0,r.kt)("td",{parentName:"tr",align:null},"secret key authentication")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"File glob"),(0,r.kt)("td",{parentName:"tr",align:null},"ListObjectV2")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"File writes"),(0,r.kt)("td",{parentName:"tr",align:null},"Multipart upload")))),(0,r.kt)("h2",{id:"reading-from-s3"},"Reading from S3:"),(0,r.kt)("p",null,"Reading from S3 is as simple as reading from regular files:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"LOAD FROM 's3://kuzu-test/follows.parquet'\nRETURN *;\n")),(0,r.kt)("h2",{id:"glob"},"Glob"),(0,r.kt)("p",null,"Globbing is implemented using the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.aws.amazon.com/AmazonS3/latest/API/API_ListObjectsV2.html"},"ListObjectV2"),"\nAPI, and allows the user to glob files as they would in their local filesystem."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'CREATE NODE TABLE tableOfTypes (\n    id INT64,\n    int64Column INT64,\n    doubleColumn DOUBLE,\n    booleanColumn BOOLEAN,\n    dateColumn DATE,\n    stringColumn STRING,\n    listOfInt64 INT64[],\n    listOfString STRING[],\n    listOfListOfInt64 INT64[][],\n    structColumn STRUCT(ID int64, name STRING),\n    PRIMARY KEY (id));\nCOPY tableOfTypes FROM "s3://kuzu-dataset-us/glob-test/types_50k_*.parquet"\n')),(0,r.kt)("h2",{id:"uploading-to-s3"},"Uploading to S3"),(0,r.kt)("p",null,"Writing to S3 uses the AWS ",(0,r.kt)("a",{parentName:"p",href:"https://docs.aws.amazon.com/AmazonS3/latest/userguide/mpuoverview.html"},"multipart upload API"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"COPY (\n    MATCH (p:Location) RETURN p.*\n) TO 's3://kuzu-dataset-us/output/location.parquet'\n")),(0,r.kt)("h2",{id:"aws-credential-management"},"AWS credential management"),(0,r.kt)("p",null,"Users can set configuration parameters through environment variables:\nSupported environments are:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Setting"),(0,r.kt)("th",{parentName:"tr",align:null},"System environment variable"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"AWS S3 key ID"),(0,r.kt)("td",{parentName:"tr",align:null},"S3_ACCESS_KEY_ID")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"AWS S3 secret key"),(0,r.kt)("td",{parentName:"tr",align:null},"S3_SECRET_ACCESS_KEY")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"AWS S3 default endpoint"),(0,r.kt)("td",{parentName:"tr",align:null},"S3_ENDPOINT")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"AWS S3 default region"),(0,r.kt)("td",{parentName:"tr",align:null},"S3_REGION")))))}m.isMDXComponent=!0}}]);