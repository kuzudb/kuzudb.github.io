"use strict";(self.webpackChunkkuzu_docs=self.webpackChunkkuzu_docs||[]).push([[7286],{3905:(t,e,a)=>{a.d(e,{Zo:()=>u,kt:()=>y});var n=a(7294);function r(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function i(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function o(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?i(Object(a),!0).forEach((function(e){r(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function s(t,e){if(null==t)return{};var a,n,r=function(t,e){if(null==t)return{};var a,n,r={},i=Object.keys(t);for(n=0;n<i.length;n++)a=i[n],e.indexOf(a)>=0||(r[a]=t[a]);return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)a=i[n],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(r[a]=t[a])}return r}var l=n.createContext({}),c=function(t){var e=n.useContext(l),a=e;return t&&(a="function"==typeof t?t(e):o(o({},e),t)),a},u=function(t){var e=c(t.components);return n.createElement(l.Provider,{value:e},t.children)},p="mdxType",m={inlineCode:"code",wrapper:function(t){var e=t.children;return n.createElement(n.Fragment,{},e)}},d=n.forwardRef((function(t,e){var a=t.components,r=t.mdxType,i=t.originalType,l=t.parentName,u=s(t,["components","mdxType","originalType","parentName"]),p=c(a),d=r,y=p["".concat(l,".").concat(d)]||p[d]||m[d]||i;return a?n.createElement(y,o(o({ref:e},u),{},{components:a})):n.createElement(y,o({ref:e},u))}));function y(t,e){var a=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var i=a.length,o=new Array(i);o[0]=d;var s={};for(var l in e)hasOwnProperty.call(e,l)&&(s[l]=e[l]);s.originalType=t,s[p]="string"==typeof t?t:r,o[1]=s;for(var c=2;c<i;c++)o[c]=a[c];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},7225:(t,e,a)=>{a.r(e),a.d(e,{assets:()=>l,contentTitle:()=>o,default:()=>m,frontMatter:()=>i,metadata:()=>s,toc:()=>c});var n=a(7462),r=(a(7294),a(3905));const i={title:"Transaction",sidebar_position:17},o="Transaction",s={unversionedId:"cypher/transaction",id:"cypher/transaction",title:"Transaction",description:"K\xf9zu is a transactional system, in that it implements a transaction management subsystem that is atomic, durable and supports serializability. Satisfying these properties makes K\xf9zu ACID-compliant, as per database terminology.",source:"@site/docs/cypher/transaction.md",sourceDirName:"cypher",slug:"/cypher/transaction",permalink:"/docusaurus/cypher/transaction",draft:!1,tags:[],version:"current",sidebarPosition:17,frontMatter:{title:"Transaction",sidebar_position:17},sidebar:"docSidebar",previous:{title:"Macro",permalink:"/docusaurus/cypher/macro"},next:{title:"Client APIs",permalink:"/docusaurus/client-apis/"}},l={},c=[{value:"Important Properties of K\xf9zu Transactions",id:"important-properties-of-k\xf9zu-transactions",level:2},{value:"Manual Transaction",id:"manual-transaction",level:2},{value:"Transaction Statement",id:"transaction-statement",level:3},{value:"Manual Transaction",id:"manual-transaction-1",level:3},{value:"Auto Transaction",id:"auto-transaction",level:3}],u={toc:c},p="wrapper";function m(t){let{components:e,...a}=t;return(0,r.kt)(p,(0,n.Z)({},u,a,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"transaction"},"Transaction"),(0,r.kt)("p",null,"K\xf9zu is a transactional system, in that it implements a transaction management subsystem that is atomic, durable and supports serializability. Satisfying these properties makes K\xf9zu ACID-compliant, as per database terminology."),(0,r.kt)("p",null,"Every query, data manipulation command, DDL (i.e., new node/rel table schema definitions), or ",(0,r.kt)("inlineCode",{parentName:"p"},"COPY FROM")," command to K\xf9zu is part of a transaction. Therefore, they depict all-or-nothing behavior, and after these commands or a set of them execute and are committed successfully, you are guaranteed that all of their changes will persist in entirety. If the commands do not execute successfully or are rolled back, you are guaranteed that none of their changes will persist."),(0,r.kt)("p",null,"These conditions hold even if your system crashes at any point during a transaction. That is, once you commit a transaction successfully, all your changes will persist even if there is an error ",(0,r.kt)("em",{parentName:"p"},"after")," committing. Similarly, if your system crashes before committing or rolling back, then none of your updates will persist."),(0,r.kt)("h2",{id:"important-properties-of-k\xf9zu-transactions"},"Important Properties of K\xf9zu Transactions"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Each transaction is identified as a read or write transaction (see below for how this is done)."),(0,r.kt)("li",{parentName:"ul"},"At any point in time, there can be multiple read transactions but ",(0,r.kt)("strong",{parentName:"li"},"one")," write transaction."),(0,r.kt)("li",{parentName:"ul"},"There are two ways to use transactions: (i) manually beginning and committing/rolling back transactions;\nor (ii) auto-committing. These are reviewed below.")),(0,r.kt)("h2",{id:"manual-transaction"},"Manual Transaction"),(0,r.kt)("h3",{id:"transaction-statement"},"Transaction Statement"),(0,r.kt)("p",null,"K\xf9zu supports the following transaction statements."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"BEGIN TRANSACTION"),": starts a read-write transaction. "),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"BEGIN TRANSACTION READ ONLY"),": starts a read-only transaction."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"COMMIT"),": commit change in current transaction."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"ROLLBACK"),": rollback change in current transaction.")),(0,r.kt)("h3",{id:"manual-transaction-1"},"Manual Transaction"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"BEGIN TRANSACTION;\nCREATE (a:User {name: 'Alice', age: 72});\nMATCH (a:User) RETURN *;\nCOMMIT;\n")),(0,r.kt)("p",null,"The above statements start a manual read-write transaction, add a new node, and within the same transaction also read all of the tuples in User table. Finally, commit the transaction."),(0,r.kt)("p",null,"You can also start a read-only transaction with ",(0,r.kt)("inlineCode",{parentName:"p"},"BEGIN TRANSACTION READ ONLY"),". Read only transactions are not allowed to write to the database. You should start a read-only transaction for two main reasons: (i) if you want to run multiple read queries ensuring that the database does not change in-between those transactions; and/or (ii) you don't want to block a write transaction from writing to the database in parallel (recall that at any point in time K\xf9zu allows 1 write transaction in the system)."),(0,r.kt)("p",null,"If you replace ",(0,r.kt)("inlineCode",{parentName:"p"},"COMMIT")," with ",(0,r.kt)("inlineCode",{parentName:"p"},"ROLLBACK"),", the added ('Alice', 72) node record will not persist in the database."),(0,r.kt)("h3",{id:"auto-transaction"},"Auto Transaction"),(0,r.kt)("p",null,"If you send a command without manually beginning a transaction and it will automatically be wrapped around a transaction. For example, the following query will be automatically wrapped around a transaction that will be executed in a serializable manner."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"CREATE (a:User {name: 'Alice', age: 72});\n")))}m.isMDXComponent=!0}}]);